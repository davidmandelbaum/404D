extends layout

block content
  link(href='/stylesheets/status.css', rel='stylesheet')
  link(href='/stylesheets/nouislider.css', rel='stylesheet')
  script(src='/javascripts/nouislider.js', type='text/javascript')
    script(src='/javascripts/liblink.js', type='text/javascript')

  div#manikin-info.center-block.waiting
    | Waiting for manikin connection

  div#index_content
    div#trial_type_form.center-block
      div.row
        div.col-md-6.col-sm-6.col-xs-6.center
          button#prof_button.btn.btn-default.btn-lg.trial_input_btn(type='button') MEDICAL PROFESSIONAL
        div.col-md-6.col-sm-6.col-xs-6.center
          button#non_prof_button.btn.btn-default.btn-lg.trial_input_btn(type='button') NON MEDICAL PROFESSIONAL
    div#non_prof_input_form.center-block.input_form
      form(action='live', method='post', role='form', class='form-horizontal')
        div.form-group
          label.col-sm-3.control-label(for='username'). Username
          div#username-content.col-sm-9
            input#username.form-control.input-lg(type='text', name='username')
        div.form-group
          label.col-sm-3.control-label(for='time'). Session length 
          div#time-content.col-sm-9
            input#time-input.form-control.input-lg(type='text', name='time')
            | &nbsp;mins
        div.form-group
          label.col-sm-3.control-label(for='capno'). Starting capno score
          div#capno-content.col-sm-9
            input#capno-input.form-control.input-lg(type='text', name='capno')
        input.btn.btn-default(type='submit', value='Start trial')

    div#prof_input_form.center-block.input_form
      form(action='live', method='post', role='form', class='form-horizontal')
        div.form-group
          label.col-sm-3.control-label(for='username'). Username
          div#username-content.col-sm-9
            input#username.form-control.input-lg(type='text', name='username')
        div.form-group
          label.col-sm-3.control-label(for='time'). Session length 
          div#time-content.col-sm-9
            input#time-input.form-control.input-lg(type='text', name='time')
            | &nbsp;mins
        div.form-group
          label.col-sm-3.control-label(for='capno'). Starting capno score
          div#capno-content.col-sm-9
            input#capno-input.form-control.input-lg(type='text', name='capno')
        input.btn.btn-default(type='submit', value='Start trial')

  script(type='text/javascript').
    var socket = io();

    socket.on('bbb_connect', function() {
      console.log('bbb connected');
      $("#manikin-info").html("Manikin connected");
      $("#manikin-info").addClass("connected");
      window.setTimeout( function() {
        $("#trial_type_form").slideDown();
      }, 500);
    });

    $("#prof_button").on('click', function() {
      if ($("#non_prof_button").hasClass("selected")) { 
        $("#non_prof_button").toggleClass("selected");
      }
      $(this).toggleClass("selected");
      $("#non_prof_input_form").hide();
      $("#prof_input_form").show();
    });

    $("#non_prof_button").on('click', function() {
      if ($("#prof_button").hasClass("selected")) { 
        $("#prof_button").toggleClass("selected");
      }
      $(this).toggleClass("selected");
      $("#prof_input_form").hide();
      $("#non_prof_input_form").show();
    });

    $("#time-slider").noUiSlider({
      start: [1],
      step: .1,
      range: {
        'min': [.1],
        'max': [10]
      }
    });

    $("#time-slider").Link('lower').to($('#time-input'));
