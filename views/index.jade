extends layout

block content
  link(href='/stylesheets/status.css', rel='stylesheet')
  link(href='/stylesheets/nouislider.css', rel='stylesheet')
  script(src='/javascripts/nouislider.js', type='text/javascript')
    script(src='/javascripts/liblink.js', type='text/javascript')

  div#manikin-info.center-block.waiting
    | Waiting for manikin connection

  div#index_content
    div#trial_type_form.center-block
      div.row
        div.col-md-6.center
          button#prof_button(type='button', class='btn btn-default btn-lg') MEDICAL PROFESSIONAL
        div.col-md-6.center
          button#non_prof_button(type='button', class='btn btn-default btn-lg') NON MEDICAL PROFESSIONAL
    div#non_prof_input_form.center-block
      form(action='live', method='post', role='form', class='form-horizontal')
        div.form-group
          label.col-sm-3.control-label(for='username'). Username
        div#username-content.col-sm-9
          input#username.form-control.input-lg(type='text', name='username', disabled)
      div.form-group
        label.col-sm-3.control-label(for='time'). Session length 
        div#time-content.col-sm-9
          div#time-slider(disabled='disabled')
            br
          input#time-input.form-control.input-lg(type='text', name='time', disabled)
          &nbsp;mins
      div.form-group
        label.col-sm-3.control-label(for='capno'). Starting capno score
        div#capno-content.col-sm-9
          input#capno-input.form-control.input-lg(type='text', name='capno', disabled)
      input.btn.btn-default(type='submit', value='Start trial', disabled)

    div#prof_input_form.center-block
      form(action='live', method='post', role='form', class='form-horizontal')
        div.form-group
          label.col-sm-3.control-label(for='username'). Username
        div#username-content.col-sm-9
          input#username.form-control.input-lg(type='text', name='username', disabled)
      div.form-group
        label.col-sm-3.control-label(for='time'). Session length 
        div#time-content.col-sm-9
          div#time-slider(disabled='disabled')
            br
          input#time-input.form-control.input-lg(type='text', name='time', disabled)
          | &nbsp;mins
      div.form-group
        label.col-sm-3.control-label(for='capno'). Starting capno score
        div#capno-content.col-sm-9
          input#capno-input.form-control.input-lg(type='text', name='capno', disabled)
      input.btn.btn-default(type='submit', value='Start trial', disabled)

  script(type='text/javascript').
    var socket = io();

    socket.on('bbb_connect', function() {
      console.log('bbb connected');
      $("#manikin-info").html("Manikin connected");
      $("#manikin-info").addClass("connected");
      window.setTimeout( function() {
        $("#trial_type_form").fadeIn();
      });
    });

    $("#prof_button").on('click', function() {
      $(this).addClass("selected");
      $("#non_prof_input_form").fadeOut();
      $("#prof_input_form").fadeIn();
    });

    $("#non_prof_button").on('click', function() {
      $(this).addClass("selected");
      $("#prof_input_form").fadeOut();
      $("#non_prof_input_form").fadeIn();
    });

    $("#time-slider").noUiSlider({
      start: [1],
      step: .1,
      range: {
        'min': [.1],
        'max': [10]
      }
    });

    $("#time-slider").Link('lower').to($('#time-input'));
